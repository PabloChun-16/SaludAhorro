<div class="saif-modal">
  <div class="modal-header bg-danger text-white">
    <h5 class="modal-title"><i class="bi bi-x-circle"></i> Eliminar Laboratorio</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
  </div>

  <form method="post" id="form-eliminar-laboratorio"
        action="{% url 'laboratorios:eliminar_laboratorio' lab.pk %}">
    <div class="modal-body">
      {% csrf_token %}
      <p>Â¿Seguro que deseas eliminar el laboratorio <strong>{{ lab.nombre_laboratorio }}</strong>?</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
      <button type="submit" class="btn btn-danger">Eliminar</button>
    </div>
  </form>
</div>

<script>
document.querySelector("#form-eliminar-laboratorio")?.addEventListener("submit", function(e) {
  e.preventDefault();

  fetch(this.action, {
    method: "POST",
    body: new FormData(this),
    headers: { "X-Requested-With": "XMLHttpRequest" }
  })
  .then(r => r.json())
  .then(data => {
    if (data.success) {
      // Eliminar fila de la tabla si existe
      const fila = document.querySelector(`#tablaLaboratorios tr[data-id="${data.id}"]`);
      if (fila) fila.remove();

      // Cerrar modal
      bootstrap.Modal.getInstance(document.getElementById("modalLaboratorio")).hide();
    }
  });
});
</script>