{% extends "home/base.html" %}
{% load static %}

{% block title %}Contacto · Farmacia Salud y Ahorro{% endblock %}

{% block content %}
<!-- =============== HERO / CARRUSEL =============== -->
<section id="hero" class="relative w-full overflow-hidden bg-green-700/5">
  <div
    id="slider"
    class="relative aspect-[25/9] min-h-[52vh] md:min-h-[60vh]"
    role="region"
    aria-roledescription="carrusel"
    aria-label="Promociones y novedades"
    tabindex="0"
  >
    <!-- Slide 1 -->
    <div class="absolute inset-0 opacity-100 transition-opacity duration-700 ease-out" data-slide aria-hidden="false">
      <img src="{% static 'home/img/carusel 1.jpg' %}" class="w-full h-full object-cover object-[25%_center]" alt="Promoción 1" loading="eager"/>
      <div class="absolute inset-0 bg-gradient-to-r from-black/50 to-transparent"></div>
      <div class="absolute left-6 md:left-16 top-1/2 -translate-y-1/2 text-white max-w-xl">
        <h1 class="text-4xl md:text-6xl font-extrabold leading-tight">Bienvenidos<br><span class="text-emerald-300">Tu salud es prioridad</span></h1>
        <a href="#contacto" class="btn btn-primary mt-5 inline-block shadow transition-transform hover:scale-105">Contáctanos</a>
      </div>
    </div>

    <!-- Slide 2 -->
    <div class="absolute inset-0 opacity-0 transition-opacity duration-700 ease-out" data-slide aria-hidden="true">
      <img src="{% static 'home/img/carusel 2.jpg' %}" class="w-full h-full object-cover object-[25%_center]" alt="Promoción 2" loading="lazy"/>
      <div class="absolute inset-0 bg-gradient-to-r from-black/50 to-transparent"></div>
      <div class="absolute left-6 md:left-16 top-1/2 -translate-y-1/2 text-white max-w-xl">
        <h2 class="text-4xl md:text-6xl font-extrabold">Dudas y pedidos<br><span class="text-emerald-300">¡Estamos para ayudarte!</span></h2>
        <a href="#contacto" class="btn btn-primary mt-5 inline-block shadow transition-transform hover:scale-105">Escríbenos</a>
      </div>
    </div>

    <!-- Slide 3 -->
    <div class="absolute inset-0 opacity-0 transition-opacity duration-700 ease-out" data-slide aria-hidden="true">
      <img src="{% static 'home/img/carusel 3.jpg' %}" class="w-full h-full object-cover object-[25%_center]" alt="Promoción 3" loading="lazy"/>
      <div class="absolute inset-0 bg-gradient-to-r from-black/50 to-transparent"></div>
      <div class="absolute left-6 md:left-16 top-1/2 -translate-y-1/2 text-white max-w-xl">
        <h2 class="text-4xl md:text-6xl font-extrabold">Atención personalizada<br><span class="text-emerald-300">¡Contáctanos hoy!</span></h2>
        <a href="#contacto" class="btn btn-primary mt-5 inline-block shadow transition-transform hover:scale-105">Enviar mensaje</a>
      </div>
    </div>
  </div>

  <!-- Controles -->
  <button id="prev" class="absolute left-3 top-1/2 -translate-y-1/2 grid place-items-center w-10 h-10 rounded-full bg-white/85 hover:bg-white shadow focus:outline-none focus:ring-2 focus:ring-emerald-500/40" aria-label="Anterior">
    <span aria-hidden="true">❮</span>
  </button>
  <button id="next" class="absolute right-3 top-1/2 -translate-y-1/2 grid place-items-center w-10 h-10 rounded-full bg-white/85 hover:bg-white shadow focus:outline-none focus:ring-2 focus:ring-emerald-500/40" aria-label="Siguiente">
    <span aria-hidden="true">❯</span>
  </button>

  <!-- Indicadores -->
  <div id="dots" class="absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-2" aria-label="Indicadores"></div>
</section>

<!-- =============== CABECERA =============== -->
<section id="contacto" class="bg-emerald-700 text-white py-14">
  <div class="container mx-auto px-4">
    <h1 class="text-3xl md:text-5xl font-extrabold">Contáctanos</h1>
    <p class="mt-2 md:max-w-3xl opacity-90">Escríbenos y te respondemos pronto.</p>
  </div>
</section>

<!-- =============== FORM + INFO =============== -->
<section class="container mx-auto px-4 py-14 grid md:grid-cols-2 gap-10">
  <!-- Formulario -->
  <form id="contact-form" class="card p-6 grid gap-4" method="post" action="#">
    {% csrf_token %}
    <!-- honeypot anti-spam -->
    <input type="text" name="website" class="sr-only" tabindex="-1" autocomplete="off" aria-hidden="true">

    <div class="grid sm:grid-cols-2 gap-4">
      <div>
        <label for="nombre" class="block text-sm font-medium text-slate-700 mb-1">Nombre</label>
        <input id="nombre" name="nombre" class="input w-full" placeholder="Juan" autocomplete="given-name" required>
      </div>
      <div>
        <label for="apellido" class="block text-sm font-medium text-slate-700 mb-1">Apellido</label>
        <input id="apellido" name="apellido" class="input w-full" placeholder="Pérez" autocomplete="family-name" required>
      </div>
    </div>

    <div>
      <label for="correo" class="block text-sm font-medium text-slate-700 mb-1">Correo</label>
      <input id="correo" name="correo" type="email" class="input w-full" placeholder="correo@ejemplo.com" autocomplete="email" required>
    </div>

    <div>
      <label for="mensaje" class="block text-sm font-medium text-slate-700 mb-1">Mensaje</label>
      <textarea id="mensaje" name="mensaje" rows="5" class="input w-full py-3" placeholder="¿En qué podemos ayudarte?" minlength="10" required></textarea>
    </div>

    <div class="flex items-center justify-between gap-3">
      <small class="text-slate-500">Al enviar aceptas nuestra política de privacidad.</small>
      <button id="submit-btn" class="btn btn-primary shadow transition-transform hover:scale-105" type="submit">Enviar</button>
    </div>

    <div id="form-alert" class="mt-2 text-sm hidden"></div>
    <div id="success-message" class="text-center text-emerald-700 font-semibold opacity-0 transition-opacity" aria-live="polite">
      ¡Formulario enviado correctamente!
    </div>
  </form>

  <!-- Información -->
  <aside class="card p-6 bg-emerald-50">
    <h3 class="font-semibold text-emerald-900">Información</h3>
    <address class="not-italic mt-3 text-slate-700 text-sm space-y-1">
      <div><strong>PBX:</strong> <a class="link" href="tel:+50223399860">2339-9860</a></div>
      <div><strong>Domicilios:</strong> <a class="link" href="tel:+5025248887">5248-887</a></div>
      <div><strong>Correo:</strong> <a class="link" href="mailto:reclutamientoFSYA@gmail.com">reclutamientoFSYA@gmail.com</a></div>
    </address>

    <div class="mt-6 rounded-xl overflow-hidden">
      <iframe
        class="w-full h-64"
        loading="lazy"
        title="Ubicación de Farmacia Salud y Ahorro en Guatemala"
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps?q=Guatemala&output=embed">
      </iframe>
    </div>

    <div class="mt-3">
      <a class="link text-sm" href="https://www.google.com/maps/search/?api=1&query=Guatemala" target="_blank" rel="noopener">Abrir en Google Maps</a>
    </div>
  </aside>
</section>

<!-- =============== REDES SOCIALES =============== -->
<div class="mb-12">
  <h2 class="text-2xl font-extrabold text-emerald-700 mb-6 text-center">Visita nuestras redes sociales</h2>
  <div class="flex flex-col items-center">
    <div class="bg-white rounded-2xl border shadow-soft p-8 w-full max-w-xl hover:shadow-lg transition">
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mt-2">
        <a href="https://www.facebook.com/FarmaciasSaludyAhorro" target="_blank" rel="noopener" class="bg-emerald-50 border border-emerald-200 rounded-xl shadow-soft p-5 flex flex-col items-center hover:bg-emerald-100 transition">
          <img src="{% static 'home/img/facebook.png' %}" alt="Logo de Facebook" class="w-16 h-16 rounded-full mb-2">
          <span class="font-semibold text-emerald-800">Facebook</span>
        </a>
        <a href="https://www.instagram.com/farmaciassaludyahorro?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw%3D%3D" target="_blank" rel="noopener" class="bg-emerald-50 border border-emerald-200 rounded-xl shadow-soft p-5 flex flex-col items-center hover:bg-emerald-100 transition">
          <img src="{% static 'home/img/instagram.png' %}" alt="Logo de Instagram" class="w-16 h-16 rounded-full mb-2">
          <span class="font-semibold text-emerald-800">Instagram</span>
        </a>
        <a href="https://www.tiktok.com/@fsya_guat?is_from_webapp=1&sender_device=pc" target="_blank" rel="noopener" class="bg-emerald-50 border border-emerald-200 rounded-xl shadow-soft p-5 flex flex-col items-center hover:bg-emerald-100 transition">
          <img src="{% static 'home/img/tiktok.png' %}" alt="Logo de TikTok" class="w-16 h-16 rounded-full mb-2">
          <span class="font-semibold text-emerald-800">TikTok</span>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- =============== JS: Formulario (simulado) =============== -->
<script>
  (function () {
    const form = document.getElementById('contact-form');
    const success = document.getElementById('success-message');
    const alertBox = document.getElementById('form-alert');
    const btn = document.getElementById('submit-btn');

    form.addEventListener('submit', function (e) {
      e.preventDefault();

      // honeypot
      if (form.website && form.website.value) return;

      const correo = form.correo.value.trim();
      const mensaje = form.mensaje.value.trim();
      const okEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(correo);

      if (!okEmail || mensaje.length < 10) {
        alertBox.className = 'mt-2 text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2';
        alertBox.textContent = 'Revisa el correo y escribe un mensaje de al menos 10 caracteres.';
        return;
      } else {
        alertBox.className = 'hidden';
        alertBox.textContent = '';
      }

      btn.textContent = 'Enviando...';
      btn.disabled = true;

      // Simulación de envío
      setTimeout(() => {
        success.style.opacity = '1';
        form.reset();
        btn.textContent = 'Enviar';
        btn.disabled = false;
        setTimeout(() => { success.style.opacity = '0'; }, 4000);
      }, 1200);
    });
  })();
</script>

<!-- =============== JS: Carrusel =============== -->
<script>
  (function(){
    const root = document.getElementById('slider');
    const slides = Array.from(root.querySelectorAll('[data-slide]'));
    const nextBtn = document.getElementById('next');
    const prevBtn = document.getElementById('prev');
    const dotsWrap = document.getElementById('dots');

    if (slides.length && nextBtn && prevBtn && dotsWrap){
      let idx=0, timer=null;

      slides.forEach((_,i)=>{
        const b=document.createElement('button');
        b.className='w-2.5 h-2.5 rounded-full bg-white/60 hover:bg-white transition';
        b.setAttribute('aria-label','Ir al slide ' + (i+1));
        b.addEventListener('click',()=>go(i,true));
        dotsWrap.appendChild(b);
      });

      function paint(){
        slides.forEach((s,i)=>{
          const active = i===idx;
          s.style.opacity = active?1:0;
          s.setAttribute('aria-hidden', String(!active));
        });
        Array.from(dotsWrap.children).forEach((d,i)=>{
          d.style.background = i===idx ? '#10B981' : 'rgba(255,255,255,.6)';
        });
      }

      function go(n,manual=false){
        idx=(n+slides.length)%slides.length; paint();
        if(manual){ restart(); }
      }
      function step(){ go(idx+1); }
      function restart(){ clearInterval(timer); timer=setInterval(step,5000); }

      nextBtn.addEventListener('click',()=>go(idx+1,true));
      prevBtn.addEventListener('click',()=>go(idx-1,true));
      root.addEventListener('keydown', (e)=>{
        if(e.key==='ArrowRight') go(idx+1,true);
        if(e.key==='ArrowLeft') go(idx-1,true);
      });
      root.addEventListener('mouseenter', ()=>clearInterval(timer));
      root.addEventListener('mouseleave', restart);

      timer=setInterval(step,5000); paint();
    }
  })();
</script>
{% endblock %}
